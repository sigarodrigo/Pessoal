#INCLUDE "PROTHEUS.CH"

User Function ETQ001()

LOCAL titulo := "Etiquetas para embalagens"
LOCAL cDesc1 := "Este programa ira emitir as etiquetas"
LOCAL cDesc2 := "para as embalagens a serem despachadas."
LOCAL cDesc3 := ""
LOCAL wnrel
LOCAL tamanho:= "G"
LOCAL cString:= "SB1"
LOCAL aOrd      := {}
LOCAL aImp      := 0

PRIVATE aReturn := { "Etiqueta", 1,"Producao", 2, 2, 1, "",1 }
PRIVATE nomeprog:="ETIKETA"
PRIVATE aLinha  := { },nLastKey := 0
PRIVATE cPerg   :=nomeprog

ValidPerg(cPerg)

pergunte(cPerg,.F.)

wnrel:=nomeprog            //Nome Default do relatorio em Disco
wnrel:=SetPrint(cString,wnrel,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,.F.,tamanho)

If nLastKey == 27
	dbClearFilter()
	Return
Endif

SetDefault(aReturn,cString)

If nLastKey == 27
	dbClearFilter()
	Return
Endif

RptStatus({|lEnd| C710Imp(@lEnd,wnRel,cString)},Titulo)

Return

***************************************************************************

Static Function C710Imp(lEnd,WnRel,cString)
LOCAL CbTxt
LOCAL titulo := "Etiquetas para embalagens"
LOCAL cDesc1 := "Este programa ira emitir as etiquetas"
LOCAL cDesc2 := "para as embalagens a serem despachadas."
LOCAL cDesc3 := ""
LOCAL nTipo, nOrdem
LOCAL CbCont,cabec1,cabec2
LOCAL tamanho:= "P"
LOCAL limite := 80
LOCAL lContinua := .T.
LOCAL aEtiq := {}
LOCAL nEtiqueta := 1
LOCAL aOrd      := {}
LOCAL aImp      := 0
LOCAL nEstaOk   := 0
LOCAL nContCol  := 1
Local cX
Local cIndex
Local lRet      := .F.
Local cCadastro := "Etiquetas de Volume"

cbtxt    := SPACE(10)
cbcont   := 0
li       := 0
col      := 0
m_pag    := 1

titulo := "ETIQUETAS PARA EMBALAGENS"
cabec1 := ""
cabec2 := ""

nTipo  := 18

SetRegua(0)		// Total de Elementos da regua

aEtiq   := {}

Aadd(aEtiq,'CT~~CD,~CC^~CT~')
Aadd(aEtiq,'^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR5,5~SD15^JUS^LRN^CI0^XZ')
Aadd(aEtiq,'~DG000.GRF,03584,056,')
Aadd(aEtiq,',::J03CC030C3F3C30FCF0C3F3C3C33F0FCC3C30FC3CFCCF03F3F3CCFCF03C3F0CC3F3C30FCF0C3F3C30FCF0C3F0F33F0F0F03F33C0,::::::::::::::::::::::::::::::::::::::::::::::::::::::,:::::~DG001.GRF,06144,064,')
Aadd(aEtiq,',::::I0202020H02300240030H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H02,K060H0C007001C003,K0E001C00F001C007,J01E007C00F003C00F,J03E00FC03F00FC03F,J07E01FC07F01FC07F,J0FE03FC0FF03FC0FF,I01FE07FC1FF07FC1FF,I03FE0FFC3FF07FC1FF,:I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,::I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF0H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H020H02,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF0hL03E0H0E80gH03E0,I03FE0FFC3FF07FC1FF0I03FF80FHF07FF00FC07800F801FC01FC1FFE07C03C00FFC03FE0H01F07C03C1FFC00780F00FF87FHF1FFC03E007C00780,I03FE0FFC3FF0FFC1FF0I03FFC0FHF0FHFC0FC07801F801FC01FC1FHF03C03C03FFC07FF0H01F07E03C1FHFH0F80F83FF87FHF1FHF03E007E00F80,I03FE0FFC3FF07FC1FF0I03FFE0FHF07FFE0FC07801FC01FC01FC1FHF87C03C07FFC0FHF8001F07E03C1FHF80780F03FF87FHF1FHF83E007E00780,I03FE0FF83FE0FFC1FF0I03C1E0F0H0F83E0FE07803FC01FE03FC1E0F83C03C0FC041F03C001F0FF03C1E0FE0F80F87C0H03E01F0F83E00FE00F80,I03FE0FF03FE07F81FF0I03C1F0F0H0783E0FF07803DE01FF03FC1F0787C03C1F8001E03E001F07F03C1E03E0780F0780H03C01F07C3E00FF00780,I03FE0FF03FC0FF01FF0H023C0F0F020F83F0FF078239E21EF23FC3F07A3C03C1F2003E01E201F2FF83C1E23F0F80FA780203E21F07C3E20EF20F82')
Aadd(aEtiq,',I03FE0FC07F80FE01FF0I03C0F0F0H0781E0F7078039E01EF03BC1F0787C03C1F0H07C01E001F07B83C1E01F0780F0780H03C01F07C3E01E700780,I03FE0F80FE03F801FF0I03C0F0F0H0F83E0F3878078F01EF87BC1E0F83C03C3E0H07C01F001F0FB83C1E00F0F80F87E0H03E01F0F83E03E780F80,I03FE0F01FC07F001FF0I03C1F0F0H0787C0F3878070F01E7873C1F1F07C03C3E0H07C01F001F079C3C1E00F0780F03F8003C01F0F83E03C7C0780,I03FE0E03F80FE001FF0I03C3E0FHF0FHFC0F3C780F0F01E7873C1FFE03C03C3E0H07C00F001F0F9E3C1E00F0F80F83FE003E01FHF03E03C3C0F80,I03FE0H07F01FC041FF0I03FFE0FHF07FF00F1C780F0781E78F3C1FHF07C03C3E0H07C00F001F078E3C1E00F0780F00FF803C01FFC03E07C3C0780,I03FE0H0FE03F80C1FF0I03FF80FHF0FHF80F1E780E0781E38E3C1FBF83C03C3E0H07C00F001F0F8E3C1E00F0F80F803F803E01FFE03E0783E0F80,I03FE001FC07F01C1FF0I03FF00F0H078F80F0F781E0781E3CE3C1F0F87C03C3E0H07C01F001F07873C1E00F0780F001FC03C01F1F03E0781E0780,I03FE007F80FE03C1FF0I03C0H0F0H0F87C0F0F781FHFC1E3CE3C1F03C3C03C3E0H07C01F001F0F87BC1E00F0F80F8007C03E01F1F03E0FHFE0F80,I03FE00FE01F80FC1FF0I03C0H0F0H0787C0F07781FHFC1E1DC3C1F03C7C03C1E0H07C01E001F0787BC1E01F0780F0H03C03C01F0F03E0FIF0780,I03FE01FC03F01FC1FF0I03C0H0F0H0F83E0F07F83FHFC1E0FC3C1E03C3C03C1F0H03C01E001F0F83FC1E01E0780F8003E03E01F0F83E0FIF0F80,I03FE03FC07F03FC1FF0I03C0H0F0H0783E0F07F83C01E1E0FC3C1F07C3E07C1F0H01E03E001F0783FC1E03E0780F0H03C03C01F0F83E1F00F0780,I03FE07FC1FF03FC1FF0I03C0H0F0H0F83E0F03F83C01E1E0F83C1F0FC3E0780FC001E03C001F0781FC1E07E07C0F0H07C03E01F0783E1F00F8F80,I03FE0FFC3FF07FC1FF0I03C0H0IF8781F0F01F87801F1E0F83C1FHF81FHF807FFC0FHF8001F0781FC1FHF803FFE07FFC03C01F07C3E1C00787FF80,I03FE0FFC3FF0FFC1FF0I03C0H0IF8F80F0F00F8F800F1E0783C1FHFH0IFH03FFC07FF8001F0F80FC1FHFH01FFE07FF803E01F07C3E3C0078FHF80,I03FE0FFC3FF07FC1FF0I03C0H0IF8780F0F00F8F800F1E0703C1FFE007FE001FFC03FE0H01F07807C1FFC0H0HF807FF003C01F03E3E3C007C7FF80,I03FE0FFC3FF0FFC1FF0H0H28020AHA8282A0A20A8A0H0A0A020082AA0201FA0H03F802F80200A2280280AA0H023E021F8202820A02A2A2800282AA80,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,::I03FE0FFC3FF0FFC1FF,I03FE0FFC3FF07FC1FF,I03FE0FFC3FF0FFC1FF0P0180,I03FE0FFC3FF07FC1FF0P01,I03FE0FFC3FF0FFC1FF0P02,I03FE0FFC3FF07FC1FF0I03C01F00FC0H07E03007C03E00C01C00C01F0H0E007C0,I03FE0FFC3FF07FC1FF0I03F83B80F80H07E03807F03B80C07A01E01FC03B80EC0,I03FE0FFC3FF07FC1FF0I031811C0C0I06007806303980C06001E018E031C1C,I03FE0FFC3FF0FFC1FF0I03183880C0I06006806303980C0C00170186060C0C,I03FE0FFC3FF07FC1FF0I0H381180C0I06004C06703980C0C00330186060C0F,I03FE0FFC3FF0FFC1FF0H023F03F00F81E27E0EC07F03F20C0E00330187060E03C20H020H020H020H020H020H020H020H020H020H020H020H020H02,I03FE0FFC3FF07FC1FF0I03001180C0140600DC06303B00C0C00778186060C01C0,I03FE0FFC3FF0FFC1FF0I03003980C0I0600FE06383980C0C007F8186060C00C0,I03FE0FF83FE07FC1FE0I030011C0C0I06018706303980C070061819C031C00C0,I03FC0FF83FC07F81FE0I030038C0FC0H06018307F03980C03E0E0C1F801F80F80,I03F80FE03F807E01FC0gQ040N04007,I03F00FE03F80FC01F8,I03E00F003E007801E0,I03C00F003C00F001C0,I03800E003800600180,I030H0C0020H0C001,,:::::::::::::::^XA')
Aadd(aEtiq,'^MMT')
Aadd(aEtiq,'^PW609')
Aadd(aEtiq,'^LL0406')
Aadd(aEtiq,'^LS0')
Aadd(aEtiq,'^FT32,288^XG000.GRF,1,1^FS')
Aadd(aEtiq,'^FT0,96^XG001.GRF,1,1^FS')
Aadd(aEtiq,'^FT49,189^A0N,20,19^FH\^FD4444444444444444^FS')
Aadd(aEtiq,'^FT13,189^A0N,20,19^FH\^FDOP:^FS')
Aadd(aEtiq,'^FT107,154^A0N,20,19^FH\^FD33333333333333333333333333^FS')
Aadd(aEtiq,'^FT14,154^A0N,20,19^FH\^FDCod. Pe\87a:^FS')
Aadd(aEtiq,'^FT334,121^A0N,20,19^FH\^FD2222^FS')
Aadd(aEtiq,'^FT284,120^A0N,20,19^FH\^FDDep.:^FS')
Aadd(aEtiq,'^FT62,121^A0N,20,19^FH\^FD11111111111111111111111^FS')
Aadd(aEtiq,'^FT13,121^A0N,20,19^FH\^FDObra:^FS')
Aadd(aEtiq,'^FT77,216^A0N,20,19^FH\^FD6666666666^FS')
Aadd(aEtiq,'^FT13,216^A0N,20,19^FH\^FDPeso (t):^FS')
Aadd(aEtiq,'^FT317,216^A0N,20,19^FH\^FD777777^FS')
Aadd(aEtiq,'^FT335,189^A0N,20,19^FH\^FD5555^FS')
Aadd(aEtiq,'^FT214,216^A0N,20,19^FH\^FDCOMP (m).:^FS')
Aadd(aEtiq,'^FT280,189^A0N,20,19^FH\^FDSeq.:^FS')
Aadd(aEtiq,'^FO490,148^GB108,75,1^FS')
Aadd(aEtiq,'^FO383,148^GB108,75,1^FS')
Aadd(aEtiq,'^FO383,74^GB108,75,1^FS')
Aadd(aEtiq,'^FO490,74^GB108,75,1^FS')
Aadd(aEtiq,'^FO414,174^GE47,43,22^FS')
Aadd(aEtiq,'^FO522,173^GE48,44,22^FS')
Aadd(aEtiq,'^FO522,99^GE48,43,22^FS')
Aadd(aEtiq,'^FO413,99^GE48,44,22^FS')
Aadd(aEtiq,'^FT510,167^A0N,14,14^FH\^FDAcabamento^FS')
Aadd(aEtiq,'^FT415,167^A0N,14,14^FH\^FDFormas^FS')
Aadd(aEtiq,'^FT516,93^A0N,14,14^FH\^FDExpedi\87\C6o^FS')
Aadd(aEtiq,'^FT407,90^A0N,14,14^FH\^FDArmadura^FS')
Aadd(aEtiq,'^PQ1,0,1,Y^XZ')
Aadd(aEtiq,'^XA^ID000.GRF^FS^XZ')
Aadd(aEtiq,'^XA^ID001.GRF^FS^XZ')

For I:= 1 TO Len(aEtiq)
	@ Prow()+1,000 PSAY aEtiq[I]
Next I

If aReturn[5] == 1
	dbCommitAll()
	ourspool(wnrel)
Endif

Return .T.

**********************************************************************

Static FuncTion ValidPerg(cPergun)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para parametros                         ³
//³ mv_par01        	// Qual a Informação OP  Quantidade      ³
//³ mv_par02        	// OP/Item/Seq                           ³
//³ mv_par03        	// Quantidade                            ³
//³ mv_par04        	// Produto                               ³
//³ mv_par05        	// Lote                                  ³
//³ mv_par06        	// Data Producao                         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

PutSx1(cPergun, "01","Usar Qual a Informação:"  ," "," ","mv_ch1","N", 01,0,0,"C","", "","","","mv_par01", "OP", "", "", "", "Produto", "", "", "", "", "", "", "", "", "", "", "", "", "" )
PutSx1(cPergun, "02","OP      :"	," "," ","mv_ch2","C", 11,0,0,"G","", "SC2OPC","","","mv_par02", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" )
PutSx1(cPergun, "03","Quantidade:" ," "," ","mv_ch3","N", 04,0,0,"G","", ""      ,"","","mv_par03", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" )
PutSx1(cPergun, "04","Produto:   "	," "," ","mv_ch4","C", 15,0,0,"G","", "SB1"   ,"","","mv_par04", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" )
PutSx1(cPergun, "05","Lote      :" ," "," ","mv_ch5","C", 01,0,0,"G","", ""      ,"","","mv_par05", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" )
PutSx1(cPergun, "06","Dt.Producao:"," "," ","mv_ch6","D", 08,0,0,"G","", ""      ,"","","mv_par06", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "" )

Return